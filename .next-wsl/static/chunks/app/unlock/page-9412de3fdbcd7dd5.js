(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{5839:function(e,t,s){Promise.resolve().then(s.bind(s,6426))},6426:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),l=s(2265),n=s(4033),r=s(9265),i=s(3861);function c(){let e=(0,n.useRouter)(),{address:t,unlocked:s,unlock:c,tryBiometricUnlock:o}=(0,r.Os)(),[u,d]=(0,l.useState)(""),[h,m]=(0,l.useState)(""),[f,x]=(0,l.useState)(""),[w,p]=(0,l.useState)(!1),[y,v]=(0,l.useState)(!1);(0,l.useEffect)(()=>{s&&e.replace("/")},[s,e]),(0,l.useEffect)(()=>{let e=(0,i.MI)();(null==e?void 0:e.scheme)&&d(e.scheme)},[]),(0,l.useEffect)(()=>{try{let e=localStorage.getItem("dope_install_hint_dismissed");v(!e)}catch(e){}},[]);let b=async t=>{t.preventDefault(),x(""),p(!0);try{await c(h),e.replace("/")}catch(e){x((null==e?void 0:e.message)||"Failed to unlock")}finally{p(!1)}},N=async()=>{x(""),p(!0);try{let t=await o();t?e.replace("/"):x("Biometric unavailable or session expired")}catch(e){x((null==e?void 0:e.message)||"Biometric failed")}finally{p(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mt-2",children:(0,a.jsx)("img",{src:"/logo-192.png",alt:"DOPE",className:"w-16 h-16 fade-in"})}),y&&(0,a.jsxs)("div",{className:"glass border border-white/10 rounded-2xl p-3 flex items-start gap-3",children:[(0,a.jsx)("div",{className:"text-sm leading-snug text-white/90",children:"For the best experience, add DOPE Wallet to your home screen."}),(0,a.jsx)("button",{"aria-label":"Dismiss",className:"ml-auto text-white/60 hover:text-white",onClick:()=>{try{localStorage.setItem("dope_install_hint_dismissed","1")}catch(e){}v(!1)},children:"\xd7"})]}),(0,a.jsxs)("div",{className:"text-center space-y-1",children:[(0,a.jsx)("div",{className:"text-xs text-white/60",children:"Wallet"}),(0,a.jsx)("div",{className:"font-semibold text-lg tracking-wide",children:t||"No wallet yet"})]}),"device"===u&&(0,a.jsx)("div",{className:"text-xs text-white/60 text-center",children:"This wallet uses device encryption. If you cleared site data, you may need to recreate/import."}),(0,a.jsxs)("form",{onSubmit:b,className:"space-y-3",children:[(0,a.jsx)("input",{type:"password",className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-3 outline-none focus:border-[#a58cff]",placeholder:"Enter password",value:h,onChange:e=>m(e.target.value),autoFocus:!0}),f&&(0,a.jsx)("div",{className:"text-[12px] text-red-400",children:f}),(0,a.jsx)("button",{disabled:w||h.length<4,className:"w-full btn disabled:opacity-50",children:w?"Unlocking...":"Unlock"})]}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("button",{onClick:N,className:"text-sm text-white/80 underline",children:"Use biometric"})}),(0,a.jsxs)("div",{className:"text-center text-xs text-white/50",children:["Donâ€™t have a wallet? ",(0,a.jsx)("a",{href:"/wallet/create",className:"underline",children:"Create"})," or ",(0,a.jsx)("a",{href:"/wallet/import",className:"underline",children:"Import"})]})]})}},9265:function(e,t,s){"use strict";s.d(t,{Ek:function(){return d},Os:function(){return u},nS:function(){return o}});var a=s(7437),l=s(2265),n=s(8870),r=s.n(n),i=s(3861);let c=(0,l.createContext)(null);function o(e){let{children:t}=e,[n,o]=(0,l.useState)(null),[u,d]=(0,l.useState)(null),[h,m]=(0,l.useState)((0,i.Ru)()),[f,x]=(0,l.useState)(!1),[w,p]=(0,l.useState)(!1),[y,v]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=(0,i.MI)();e?(o(e.pubkey),p(!0)):p(!1),m((0,i.Ru)()),(0,i.SX)().then(x).catch(()=>x(!1)),(async()=>{try{if((null==e?void 0:e.scheme)==="device"){let e=await (0,i.s6)();d(e),m(!0)}}catch(e){}})();let t=()=>{let e=(0,i.MI)();e&&(o(e.pubkey),p(!0))};return window.addEventListener("dope:store",t),()=>{window.removeEventListener("dope:store",t)}},[]),(0,l.useEffect)(()=>{v(!0)},[]);let b=async e=>{let t=await (0,i.Z9)(e);return o(t.address),p(!0),t},N=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"phantom",a=arguments.length>3?arguments[3]:void 0,l="string"==typeof s&&s.startsWith("m/"),n=l?await (0,i.ir)(e,t,s,a):await (0,i.o4)(e,t,s,a);return o(n.address),p(!0),n},g=async(e,t)=>{let a=null,l=e.trim();try{if(l.startsWith("[")){let e=JSON.parse(l);Array.isArray(e)&&(a=new Uint8Array(e.map(e=>Number(e))))}else if(/^[A-Za-z0-9+/=]+$/.test(l)&&l.includes("=")){let e=atob(l),t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);a=t}else/^[1-9A-HJ-NP-Za-km-z]+$/.test(l)&&(a=r().decode(l))}catch(e){}if(!a)throw Error("Invalid keypair input. Paste JSON array, base58, or base64 secret key.");let{importWalletFromSecretKey:n}=await Promise.resolve().then(s.bind(s,3861)),i=await n(a,t);return o(i.address),p(!0),i},j=async e=>{let t=await (0,i.fK)(e);d(t),m(!0)},S=async()=>{if(!f)return!1;let e=await (0,i.B9)();return!!(e&&(0,i.Ru)())&&(m(!0),!0)};return(0,a.jsx)(c.Provider,{value:{address:n,unlocked:h,keypair:u,hasWallet:w,ready:y,createWallet:b,importWallet:N,importKeypair:g,unlock:j,tryBiometricUnlock:S,lock:()=>{d(null),m(!1)},logout:()=>{d(null),(0,i.QD)(),m(!1),o(null),p(!1)}},children:t})}function u(){let e=(0,l.useContext)(c);if(!e)throw Error("useWallet must be used within WalletProvider");return e}function d(){return(0,l.useContext)(c)}},4033:function(e,t,s){e.exports=s(8165)}},function(e){e.O(0,[814,727,711,971,596,744],function(){return e(e.s=5839)}),_N_E=e.O()}]);