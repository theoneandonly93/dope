(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[808],{6925:function(e,t,a){Promise.resolve().then(a.bind(a,8636))},8636:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var n=a(7437),l=a(2265),r=a(4033),s=a(9265),i=a(3438),o=a(8870),c=a.n(o),u=a(3861),d=a(8745);async function h(e){try{var t,a,n;let l=(0,u.B5)(),r=new i.nh(e),s=new i.nh(d.Fz),o=await l.getParsedTokenAccountsByOwner(r,{mint:s});if(!o||0===o.value.length)return 0;let c=o.value[0].account.data,h=null==c?void 0:null===(n=c.parsed)||void 0===n?void 0:null===(a=n.info)||void 0===a?void 0:null===(t=a.tokenAmount)||void 0===t?void 0:t.uiAmount;return"number"==typeof h?h:0}catch(e){return 0}}async function p(e,t){let a=[],n=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,l=[];for(let e=0;e<=t;e++)for(let t=0;t<=a;t++){l.push("m/44'/501'/".concat(e,"'/").concat(t,"'"));for(let a=0;a<=n;a++)l.push("m/44'/501'/".concat(e,"'/").concat(t,"'/").concat(a,"'"))}let r=u.n5.map(e=>e.path);return e=[...r,...l],Array.from(new Set(e))}();for(let l of n)try{let n=await (0,u.Tf)(e,l,t),r=n.publicKey.toBase58(),s=await h(r);a.push({path:l,pubkey:r,balance:s})}catch(e){}return a}function m(){let e=(0,r.useRouter)(),{importWallet:t,importKeypair:a}=(0,s.Os)(),[o,d]=(0,l.useState)(""),[h,m]=(0,l.useState)(""),[f,x]=(0,l.useState)(""),[y,b]=(0,l.useState)(!1),[w,v]=(0,l.useState)("phantom"),[g,N]=(0,l.useState)([]),[j,S]=(0,l.useState)(!1),[k,A]=(0,l.useState)(""),[C,P]=(0,l.useState)(""),[O,E]=(0,l.useState)(!1),[I,D]=(0,l.useState)(""),B=async a=>{a.preventDefault(),x(""),b(!0);try{await t(o.trim().toLowerCase(),h,w,k||void 0),e.replace("/unlock")}catch(e){x((null==e?void 0:e.message)||"Failed to import")}finally{b(!1)}},J=async()=>{S(!0),N([]),x("");try{let e=await p(o.trim().toLowerCase(),k||void 0);N(e)}catch(e){x((null==e?void 0:e.message)||"Scan failed")}finally{S(!1)}},K=async a=>{var n;let l=(null===(n=u.n5.find(e=>e.path===a))||void 0===n?void 0:n.key)||"phantom";if(v(l),h.length>=6)try{b(!0),await t(o.trim().toLowerCase(),h,a,k||void 0),e.replace("/unlock")}catch(e){x((null==e?void 0:e.message)||"Failed to import")}finally{b(!1)}},W=async()=>{x(""),E(!0);try{await a(C,h),e.replace("/unlock")}catch(e){x((null==e?void 0:e.message)||"Failed to import keypair")}finally{E(!1)}},_=e=>{P(e),D("");let t=function(e){let t=e.trim();if(!t)return null;try{if(t.startsWith("[")){let e=JSON.parse(t);if(Array.isArray(e))return new Uint8Array(e.map(e=>Number(e)))}else if(/^[A-Za-z0-9+/=]+$/.test(t)&&t.includes("=")){let e=atob(t),a=new Uint8Array(e.length);for(let t=0;t<e.length;t++)a[t]=e.charCodeAt(t);return a}else if(/^[1-9A-HJ-NP-Za-km-z]+$/.test(t))return c().decode(t)}catch(e){}return null}(e);if(t&&(64===t.length||32===t.length))try{let e=i.RG.fromSecretKey(64===t.length?t:(()=>{let e=new Uint8Array(64);return e.set(t),e})());D(e.publicKey.toBase58())}catch(e){}};return(0,n.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold",children:"Import Wallet"}),(0,n.jsx)("textarea",{className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-3 outline-none focus:border-[#a58cff] min-h-[110px]",placeholder:"Secret phrase (12 or 24 words)",value:o,onChange:e=>d(e.target.value)}),(0,n.jsx)("input",{type:"password",className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-3 outline-none focus:border-[#a58cff]",placeholder:"New password",value:h,onChange:e=>m(e.target.value)}),(0,n.jsx)("input",{type:"password",className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-3 outline-none focus:border-[#a58cff]",placeholder:"BIP39 passphrase (optional)",value:k,onChange:e=>A(e.target.value)}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)("button",{type:"button",onClick:J,className:"btn",disabled:j||o.split(" ").length<12,children:j?"Scanning...":"Scan Accounts"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs text-white/60 mb-1",children:"Derivation Path"}),(0,n.jsx)("select",{value:w,onChange:e=>v(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 outline-none",children:u.n5.map(e=>(0,n.jsx)("option",{value:e.key,children:e.label},e.key))}),(0,n.jsx)("div",{className:"text-[11px] text-white/50 mt-1",children:"Pick the path where the wallet was originally created (Phantom/Sollet/etc)."})]}),f&&(0,n.jsx)("div",{className:"text-[12px] text-red-400",children:f}),(0,n.jsx)("button",{disabled:y||h.length<6||o.split(" ").length<12,className:"w-full btn disabled:opacity-50",children:y?"Importing...":"Import"}),g.length>0&&(0,n.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,n.jsx)("div",{className:"text-sm font-semibold",children:"Detected Accounts"}),(0,n.jsx)("div",{className:"rounded-xl border border-white/10 overflow-hidden overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-sm min-w-[640px]",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left bg-white/5",children:[(0,n.jsx)("th",{className:"px-3 py-2",children:"Derivation Path"}),(0,n.jsx)("th",{className:"px-3 py-2",children:"Public Key"}),(0,n.jsx)("th",{className:"px-3 py-2",children:"DOPE Balance"}),(0,n.jsx)("th",{className:"px-3 py-2",children:"Action"})]})}),(0,n.jsx)("tbody",{children:g.map((e,t)=>(0,n.jsxs)("tr",{className:"border-t border-white/10",children:[(0,n.jsx)("td",{className:"px-3 py-2 font-mono text-xs break-all",children:e.path}),(0,n.jsx)("td",{className:"px-3 py-2 font-mono text-xs break-all",children:e.pubkey}),(0,n.jsxs)("td",{className:"px-3 py-2",children:[e.balance.toFixed(4)," DOPE"]}),(0,n.jsx)("td",{className:"px-3 py-2",children:(0,n.jsx)("button",{type:"button",className:"btn text-xs",onClick:()=>K(e.path),children:"Set as Main"})})]},t))})]})})]}),(0,n.jsxs)("div",{className:"space-y-3 mt-6",children:[(0,n.jsx)("div",{className:"text-sm font-semibold",children:"Or import from keypair (id.json)"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("textarea",{className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-3 outline-none focus:border-[#a58cff] min-h-[110px]",placeholder:"Paste keypair JSON array or base58/base64 secret",value:C,onChange:e=>_(e.target.value)}),I&&(0,n.jsxs)("div",{className:"text-xs text-white/70",children:["Derived Public Key: ",(0,n.jsx)("span",{className:"font-mono",children:I})]}),(0,n.jsx)("button",{type:"button",onClick:W,className:"w-full btn disabled:opacity-50",disabled:O||h.length<6||C.trim().length<3,children:O?"Importing...":"Import Keypair"}),(0,n.jsx)("div",{className:"text-[11px] text-white/50",children:"Tip: To get your JSON, open ~/.config/solana/id.json and paste the full array (e.g., [159,150,...])."})]})]})]})}},9265:function(e,t,a){"use strict";a.d(t,{Ek:function(){return d},Os:function(){return u},nS:function(){return c}});var n=a(7437),l=a(2265),r=a(8870),s=a.n(r),i=a(3861);let o=(0,l.createContext)(null);function c(e){let{children:t}=e,[r,c]=(0,l.useState)(null),[u,d]=(0,l.useState)(null),[h,p]=(0,l.useState)((0,i.Ru)()),[m,f]=(0,l.useState)(!1),[x,y]=(0,l.useState)(!1),[b,w]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=(0,i.MI)();e?(c(e.pubkey),y(!0)):y(!1),p((0,i.Ru)()),(0,i.SX)().then(f).catch(()=>f(!1)),(async()=>{try{if((null==e?void 0:e.scheme)==="device"){let e=await (0,i.s6)();d(e),p(!0)}}catch(e){}})();let t=()=>{let e=(0,i.MI)();e&&(c(e.pubkey),y(!0))};return window.addEventListener("dope:store",t),()=>{window.removeEventListener("dope:store",t)}},[]),(0,l.useEffect)(()=>{w(!0)},[]);let v=async e=>{let t=await (0,i.Z9)(e);return c(t.address),y(!0),t},g=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"phantom",n=arguments.length>3?arguments[3]:void 0,l="string"==typeof a&&a.startsWith("m/"),r=l?await (0,i.ir)(e,t,a,n):await (0,i.o4)(e,t,a,n);return c(r.address),y(!0),r},N=async(e,t)=>{let n=null,l=e.trim();try{if(l.startsWith("[")){let e=JSON.parse(l);Array.isArray(e)&&(n=new Uint8Array(e.map(e=>Number(e))))}else if(/^[A-Za-z0-9+/=]+$/.test(l)&&l.includes("=")){let e=atob(l),t=new Uint8Array(e.length);for(let a=0;a<e.length;a++)t[a]=e.charCodeAt(a);n=t}else/^[1-9A-HJ-NP-Za-km-z]+$/.test(l)&&(n=s().decode(l))}catch(e){}if(!n)throw Error("Invalid keypair input. Paste JSON array, base58, or base64 secret key.");let{importWalletFromSecretKey:r}=await Promise.resolve().then(a.bind(a,3861)),i=await r(n,t);return c(i.address),y(!0),i},j=async e=>{let t=await (0,i.fK)(e);d(t),p(!0)},S=async()=>{if(!m)return!1;let e=await (0,i.B9)();return!!(e&&(0,i.Ru)())&&(p(!0),!0)};return(0,n.jsx)(o.Provider,{value:{address:r,unlocked:h,keypair:u,hasWallet:x,ready:b,createWallet:v,importWallet:g,importKeypair:N,unlock:j,tryBiometricUnlock:S,lock:()=>{d(null),p(!1)},logout:()=>{d(null),(0,i.QD)(),p(!1),c(null),y(!1)}},children:t})}function u(){let e=(0,l.useContext)(o);if(!e)throw Error("useWallet must be used within WalletProvider");return e}function d(){return(0,l.useContext)(o)}},4033:function(e,t,a){e.exports=a(8165)}},function(e){e.O(0,[814,727,711,971,596,744],function(){return e(e.s=6925)}),_N_E=e.O()}]);