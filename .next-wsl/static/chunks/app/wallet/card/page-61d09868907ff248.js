(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[963],{7200:function(e,t,s){Promise.resolve().then(s.bind(s,236))},236:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),n=s(2265),r=s(1396),i=s.n(r),l=s(9265);function c(){let{address:e}=(0,l.Os)(),[t,s]=(0,n.useState)(0),[r,c]=(0,n.useState)([]),[d,o]=(0,n.useState)(!1),u=async()=>{if(e){o(!0);try{let[t,a]=await Promise.all([fetch("/api/card/balance?pubkey=".concat(e),{cache:"no-store"}).then(e=>e.json()),fetch("/api/card/transactions?pubkey=".concat(e),{cache:"no-store"}).then(e=>e.json())]);(null==t?void 0:t.ok)&&s(Number(t.balance||0)),(null==a?void 0:a.ok)&&Array.isArray(a.txs)&&c(a.txs)}catch(e){}o(!1)}};return(0,n.useEffect)(()=>{u();let e=setInterval(u,1e4);return()=>clearInterval(e)},[e]),(0,a.jsxs)("div",{className:"space-y-6 pb-24",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"Card"}),(0,a.jsxs)("div",{className:"glass rounded-2xl p-5 border border-white/10",children:[(0,a.jsx)("div",{className:"text-xs text-white/60",children:"USDC Balance"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:[t.toFixed(2)," ",(0,a.jsx)("span",{className:"text-base font-medium text-white/60",children:"USDC"})]}),(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,a.jsx)(i(),{href:"/wallet/card/topup",className:"btn",children:"Top Up Card"}),(0,a.jsx)(i(),{href:"/card",className:"btn",children:"Virtual Card"})]})]}),(0,a.jsxs)("div",{className:"glass rounded-2xl p-5 border border-white/10",children:[(0,a.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Card Activity"}),d&&0===r.length&&(0,a.jsx)("div",{className:"text-white/70 text-sm",children:"Loading..."}),!d&&0===r.length&&(0,a.jsx)("div",{className:"text-white/60 text-sm",children:"No activity yet"}),(0,a.jsx)("div",{className:"divide-y divide-white/10",children:r.map(e=>(0,a.jsxs)("div",{className:"py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"topup"===e.type?"Top-up":"Spend"}),(0,a.jsx)("div",{className:"text-xs text-white/60",children:e.desc||new Date(1e3*e.time).toLocaleString()})]}),(0,a.jsxs)("div",{className:"text-sm font-semibold ".concat("topup"===e.type?"text-green-400":"text-red-400"),children:["topup"===e.type?"+":"-",e.amount.toFixed(2)," ",e.currency]})]},e.id))})]}),!e&&(0,a.jsxs)("div",{className:"text-white/70 text-sm",children:["No wallet yet. ",(0,a.jsx)(i(),{href:"/get-started",className:"underline",children:"Create one"}),"."]})]})}},9265:function(e,t,s){"use strict";s.d(t,{Ek:function(){return u},Os:function(){return o},nS:function(){return d}});var a=s(7437),n=s(2265),r=s(8870),i=s.n(r),l=s(3861);let c=(0,n.createContext)(null);function d(e){let{children:t}=e,[r,d]=(0,n.useState)(null),[o,u]=(0,n.useState)(null),[h,x]=(0,n.useState)((0,l.Ru)()),[m,f]=(0,n.useState)(!1),[p,v]=(0,n.useState)(!1),[y,w]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=(0,l.MI)();e?(d(e.pubkey),v(!0)):v(!1),x((0,l.Ru)()),(0,l.SX)().then(f).catch(()=>f(!1)),(async()=>{try{if((null==e?void 0:e.scheme)==="device"){let e=await (0,l.s6)();u(e),x(!0)}}catch(e){}})();let t=()=>{let e=(0,l.MI)();e&&(d(e.pubkey),v(!0))};return window.addEventListener("dope:store",t),()=>{window.removeEventListener("dope:store",t)}},[]),(0,n.useEffect)(()=>{w(!0)},[]);let b=async e=>{let t=await (0,l.Z9)(e);return d(t.address),v(!0),t},N=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"phantom",a=arguments.length>3?arguments[3]:void 0,n="string"==typeof s&&s.startsWith("m/"),r=n?await (0,l.ir)(e,t,s,a):await (0,l.o4)(e,t,s,a);return d(r.address),v(!0),r},j=async(e,t)=>{let a=null,n=e.trim();try{if(n.startsWith("[")){let e=JSON.parse(n);Array.isArray(e)&&(a=new Uint8Array(e.map(e=>Number(e))))}else if(/^[A-Za-z0-9+/=]+$/.test(n)&&n.includes("=")){let e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);a=t}else/^[1-9A-HJ-NP-Za-km-z]+$/.test(n)&&(a=i().decode(n))}catch(e){}if(!a)throw Error("Invalid keypair input. Paste JSON array, base58, or base64 secret key.");let{importWalletFromSecretKey:r}=await Promise.resolve().then(s.bind(s,3861)),l=await r(a,t);return d(l.address),v(!0),l},S=async e=>{let t=await (0,l.fK)(e);u(t),x(!0)},g=async()=>{if(!m)return!1;let e=await (0,l.B9)();return!!(e&&(0,l.Ru)())&&(x(!0),!0)};return(0,a.jsx)(c.Provider,{value:{address:r,unlocked:h,keypair:o,hasWallet:p,ready:y,createWallet:b,importWallet:N,importKeypair:j,unlock:S,tryBiometricUnlock:g,lock:()=>{u(null),x(!1)},logout:()=>{u(null),(0,l.QD)(),x(!1),d(null),v(!1)}},children:t})}function o(){let e=(0,n.useContext)(c);if(!e)throw Error("useWallet must be used within WalletProvider");return e}function u(){return(0,n.useContext)(c)}}},function(e){e.O(0,[814,727,847,711,971,596,744],function(){return e(e.s=7200)}),_N_E=e.O()}]);