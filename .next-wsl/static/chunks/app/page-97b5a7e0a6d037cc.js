(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{40:function(e,t,s){Promise.resolve().then(s.bind(s,7682))},7682:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var n=s(7437),a=s(2265),l=s(1396),r=s.n(l),i=s(4033),c=s(9265),d=s(3861),o=s(3438),u=s(5231),x=s(289),h=s(8745);async function m(e){let t=(0,d.B5)(),s=new o.nh(h.Fz),n=await (0,u._)(t,e,s,e.publicKey);return n.address}async function f(e){let t=(0,d.B5)(),s=new o.nh(h.Fz),n=await t.getParsedTokenAccountsByOwner(e,{mint:s});return n.value.map(e=>{var t,s,n,a;return{address:e.pubkey,rawAmount:BigInt((null===(a=e.account.data)||void 0===a?void 0:null===(n=a.parsed)||void 0===n?void 0:null===(s=n.info)||void 0===s?void 0:null===(t=s.tokenAmount)||void 0===t?void 0:t.amount)||"0")}})}async function v(e){let t=(0,d.B5)(),s=e.publicKey,n=new o.nh(h.Fz),a=await m(e),l=await f(s),r=l.filter(e=>e.address.toBase58()!==a.toBase58()&&e.rawAmount>BigInt(0)),i=BigInt(0);for(let s of r)try{await (0,x.f)(t,e,s.address,n,a,e,s.rawAmount,9),i+=s.rawAmount}catch(e){}return{ata:a.toBase58(),movedUi:Number(i)/1e9}}function w(e){let{address:t}=e,[s,l]=(0,a.useState)([]),[r,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=!0,s=async()=>{if(t)try{i(!0);let s=await (0,d.tU)(t,10);e&&l(s)}finally{i(!1)}};s();let n=setInterval(s,15e3);return()=>{e=!1,clearInterval(n)}},[t]),(0,n.jsxs)("div",{className:"glass rounded-2xl p-5 border border-white/5",children:[(0,n.jsx)("div",{className:"text-sm font-semibold mb-3",children:"Recent Activity"}),r&&0===s.length&&(0,n.jsx)("div",{className:"text-white/60 text-sm",children:"Loading..."}),!r&&0===s.length&&(0,n.jsx)("div",{className:"text-white/60 text-sm",children:"No recent transactions"}),(0,n.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,n.jsxs)("a",{href:"https://explorer.solana.com/tx/".concat(e.signature,"?cluster=custom"),target:"_blank",rel:"noreferrer",className:"flex items-center justify-between p-3 rounded-lg border border-white/10 hover:bg-white/5",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"text-xs text-white/60",children:"success"===e.status?"Confirmed":"error"===e.status?"Failed":"Pending"}),(0,n.jsxs)("span",{className:"font-mono text-xs break-all max-w-[220px]",children:[e.signature.slice(0,12),"…",e.signature.slice(-6)]})]}),(0,n.jsx)("div",{className:"text-sm font-semibold ".concat("number"==typeof e.change?e.change>=0?"text-green-400":"text-red-400":"text-white/70"),children:"number"==typeof e.change?"".concat(e.change>=0?"+":"").concat(e.change.toFixed(4)," DOPE"):"—"})]},e.signature))})]})}function b(){(0,i.useRouter)();let{address:e,unlocked:t,hasWallet:s,keypair:l,ready:o}=(0,c.Os)(),[u,x]=(0,a.useState)(null),[h,m]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),[N,y]=(0,a.useState)("");(0,a.useEffect)(()=>{if(!e)return;let t=null,s=null,n=()=>(0,d.yZ)(e).then(x).catch(()=>x(null));n(),(0,d._f)(e).then(m).catch(()=>m(null));try{t=(0,d.iB)(e,x)}catch(e){}return t||(s=setInterval(n,15e3)),()=>{var e;null===(e=t)||void 0===e||e(),s&&clearInterval(s)}},[e]);let j=async()=>{y(""),b(!0);try{if(!l){y("Unlock the wallet first, then try again.");return}let t=await v(l);y("Synced. Consolidated ".concat(t.movedUi.toFixed(6)," DOPE to ATA.")),e&&(0,d._f)(e).then(m).catch(()=>{})}catch(e){y((null==e?void 0:e.message)||"Sync failed")}finally{b(!1)}};return s?(0,n.jsxs)("div",{className:"pb-24 space-y-6",children:[(0,n.jsxs)("div",{className:"glass rounded-2xl p-5 border border-white/5",children:[(0,n.jsx)("div",{className:"text-xs text-white/60",children:"Address"}),(0,n.jsx)("div",{className:"font-mono break-all text-sm",children:e}),(0,n.jsx)("div",{className:"mt-4 text-xs text-white/60",children:"Balance"}),(0,n.jsxs)("div",{className:"text-3xl font-bold",children:[null===u?"—":u.toFixed(4)," ",(0,n.jsx)("span",{className:"text-base font-medium text-white/60",children:"DOPE"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsx)(r(),{href:"/wallet/send",className:"btn text-center",children:"Send"}),(0,n.jsx)(r(),{href:"/wallet/receive",className:"btn text-center",children:"Receive"})]}),(0,n.jsxs)("div",{className:"glass rounded-2xl p-5 border border-white/5",children:[(0,n.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Tokens"}),(0,n.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("img",{src:"/logo-192.png",alt:"DOPE",className:"w-9 h-9 rounded-full"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-semibold",children:"DOPE (native)"}),(0,n.jsx)("div",{className:"text-xs text-white/60",children:"Network currency (SOL)"})]})]}),(0,n.jsxs)("div",{className:"text-sm font-semibold",children:[null===u?"—":u.toFixed(4)," DOPE"]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between py-2 border-t border-white/10 mt-2 pt-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("img",{src:"/logo-192.png",alt:"DOPE",className:"w-9 h-9 rounded-full"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-semibold",children:"DOPE (SPL)"}),(0,n.jsx)("div",{className:"text-xs text-white/60",children:"Token balance (mint)"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("div",{className:"text-sm font-semibold",children:[null===h?"—":h.toFixed(4)," DOPE"]}),(0,n.jsx)("button",{className:"btn text-xs",onClick:j,disabled:f||!l,children:f?"Syncing…":"Sync"}),!l&&(0,n.jsx)(r(),{href:"/unlock",className:"text-xs underline text-white/70",children:"Unlock"})]})]}),N&&(0,n.jsx)("div",{className:"text-xs text-white/70 mt-2",children:N})]}),(0,n.jsx)(w,{address:e})]}):(0,n.jsxs)("div",{className:"space-y-5",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold",children:"Welcome to DOPE"}),(0,n.jsx)("p",{className:"text-white/70 text-sm",children:"Create a DOPE wallet in seconds."}),(0,n.jsx)(r(),{href:"/get-started",className:"btn w-full text-center",children:"Get Started"}),(0,n.jsxs)("div",{className:"text-center text-xs text-white/60",children:["Already have a wallet? ",(0,n.jsx)(r(),{href:"/wallet/import",className:"underline",children:"Import"})]})]})}},9265:function(e,t,s){"use strict";s.d(t,{Ek:function(){return u},Os:function(){return o},nS:function(){return d}});var n=s(7437),a=s(2265),l=s(8870),r=s.n(l),i=s(3861);let c=(0,a.createContext)(null);function d(e){let{children:t}=e,[l,d]=(0,a.useState)(null),[o,u]=(0,a.useState)(null),[x,h]=(0,a.useState)((0,i.Ru)()),[m,f]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[b,N]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=(0,i.MI)();e?(d(e.pubkey),w(!0)):w(!1),h((0,i.Ru)()),(0,i.SX)().then(f).catch(()=>f(!1)),(async()=>{try{if((null==e?void 0:e.scheme)==="device"){let e=await (0,i.s6)();u(e),h(!0)}}catch(e){}})();let t=()=>{let e=(0,i.MI)();e&&(d(e.pubkey),w(!0))};return window.addEventListener("dope:store",t),()=>{window.removeEventListener("dope:store",t)}},[]),(0,a.useEffect)(()=>{N(!0)},[]);let y=async e=>{let t=await (0,i.Z9)(e);return d(t.address),w(!0),t},j=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"phantom",n=arguments.length>3?arguments[3]:void 0,a="string"==typeof s&&s.startsWith("m/"),l=a?await (0,i.ir)(e,t,s,n):await (0,i.o4)(e,t,s,n);return d(l.address),w(!0),l},p=async(e,t)=>{let n=null,a=e.trim();try{if(a.startsWith("[")){let e=JSON.parse(a);Array.isArray(e)&&(n=new Uint8Array(e.map(e=>Number(e))))}else if(/^[A-Za-z0-9+/=]+$/.test(a)&&a.includes("=")){let e=atob(a),t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);n=t}else/^[1-9A-HJ-NP-Za-km-z]+$/.test(a)&&(n=r().decode(a))}catch(e){}if(!n)throw Error("Invalid keypair input. Paste JSON array, base58, or base64 secret key.");let{importWalletFromSecretKey:l}=await Promise.resolve().then(s.bind(s,3861)),i=await l(n,t);return d(i.address),w(!0),i},g=async e=>{let t=await (0,i.fK)(e);u(t),h(!0)},k=async()=>{if(!m)return!1;let e=await (0,i.B9)();return!!(e&&(0,i.Ru)())&&(h(!0),!0)};return(0,n.jsx)(c.Provider,{value:{address:l,unlocked:x,keypair:o,hasWallet:v,ready:b,createWallet:y,importWallet:j,importKeypair:p,unlock:g,tryBiometricUnlock:k,lock:()=>{u(null),h(!1)},logout:()=>{u(null),(0,i.QD)(),h(!1),d(null),w(!1)}},children:t})}function o(){let e=(0,a.useContext)(c);if(!e)throw Error("useWallet must be used within WalletProvider");return e}function u(){return(0,a.useContext)(c)}}},function(e){e.O(0,[814,727,847,199,711,971,596,744],function(){return e(e.s=40)}),_N_E=e.O()}]);